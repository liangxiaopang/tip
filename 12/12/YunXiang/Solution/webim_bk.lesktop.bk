{"CreatedTime":{"__DataType":"Date","__Value":1274925225296.88},"Solution":"{\u0022Data\u0022:{\u0022Forms\u0022:[{\u0022Constructor\u0022:\u0022CustomControlDesignPH\u0022,\u0022Config\u0022:{\u0022Controls\u0022:[{\u0022Constructor\u0022:\u0022SimpleTabControlPH\u0022,\u0022Config\u0022:{\u0022_Css\u0022:\u0022simple_tab\u0022,\u0022_BorderWidth\u0022:1,\u0022OnSelectedTabCode\u0022:\u0022\u0022,\u0022InitCode\u0022:\u0022\u0022,\u0022Tabs\u0022:[{\u0022Text\u0022:\u0022聊天\u0022,\u0022Width\u0022:80,\u0022ID\u0022:\u0022ID000020\u0022,\u0022IsSelected\u0022:true}],\u0022DesignPHBs\u0022:[{\u0022Constructor\u0022:\u0022SimplePlaceHolder\u0022,\u0022Config\u0022:{\u0022Controls\u0022:[{\u0022Constructor\u0022:\u0022CustomControlObjectPH\u0022,\u0022Config\u0022:{\u0022_Css\u0022:\u0022control\u0022,\u0022ConfigCode\u0022:\u0022\u0022,\u0022InitCode\u0022:\u0022\u0022,\u0022ClassName\u0022:\u0022MsgPanel\u0022,\u0022Count\u0022:0,\u0022Left\u0022:5,\u0022Top\u0022:5,\u0022Width\u0022:472,\u0022Height\u0022:231,\u0022Name\u0022:\u0022m_MsgPanel\u0022,\u0022Text\u0022:\u0022\u0022,\u0022AnchorStyle\u0022:15}},{\u0022Constructor\u0022:\u0022ButtonPH\u0022,\u0022Config\u0022:{\u0022_Css\u0022:\u0022button_default\u0022,\u0022OnClickCode\u0022:\u0022var data = {\u005Cu000d\u005Cu000a    Sender: User\u005Cu002c\u005Cu000d\u005Cu000a    Receiver: Peer\u005Cu002c\u005Cu000d\u005Cu000a    Content: m_MsgEditor.GetValue()\u005Cu000d\u005Cu000a};\u005Cu000d\u005Cu000a\u005Cu000d\u005Cu000am_MsgPanel.AddMessage(data);\u005Cu000d\u005Cu000am_MsgEditor.SetValue(\u005Cu0022\u005Cu0022);\u005Cu000d\u005Cu000a\u005Cu000d\u005Cu000afunction Send_Error(ex)\u005Cu000d\u005Cu000a{\u005Cu000d\u005Cu000a    alert(ex);\u005Cu000d\u005Cu000a}\u005Cu000d\u005Cu000a\u005Cu000d\u005Cu000afunction Send_Callback(xml\u005Cu002c text)\u005Cu000d\u005Cu000a{\u005Cu000d\u005Cu000a    var message = System.ParseJson(text);\u005Cu000d\u005Cu000a}\u005Cu000d\u005Cu000a\u005Cu000d\u005Cu000aSystem.Post(Send_Callback\u005Cu002c Send_Error\u005Cu002c \u005Cu0022send.aspx\u005Cu0022\u005Cu002c System.RenderJson(data));\u0022,\u0022InitCode\u0022:\u0022\u0022,\u0022Count\u0022:0,\u0022Left\u0022:410,\u0022Top\u0022:415,\u0022Width\u0022:67,\u0022Height\u0022:26,\u0022Name\u0022:\u0022m_BtnOK\u0022,\u0022Text\u0022:\u0022发送\u0022,\u0022AnchorStyle\u0022:12}},{\u0022Constructor\u0022:\u0022CustomControlObjectPH\u0022,\u0022Config\u0022:{\u0022_Css\u0022:\u0022control\u0022,\u0022ConfigCode\u0022:\u0022m_MsgEditor_Config.BorderWidth = 1;\u005Cu000d\u005Cu000am_MsgEditor_Config.Css = \u005Cu0022richEditor\u005Cu0022;\u0022,\u0022InitCode\u0022:\u0022\u0022,\u0022ClassName\u0022:\u0022MsgEditor\u0022,\u0022Count\u0022:0,\u0022Left\u0022:5,\u0022Top\u0022:243,\u0022Width\u0022:472,\u0022Height\u0022:166,\u0022Name\u0022:\u0022m_MsgEditor\u0022,\u0022Text\u0022:\u0022\u0022,\u0022AnchorStyle\u0022:13}}],\u0022Count\u0022:0,\u0022Left\u0022:0,\u0022Top\u0022:0,\u0022Width\u0022:482,\u0022Height\u0022:449,\u0022Name\u0022:\u0022tab1.GetPanel(0)\u0022,\u0022Text\u0022:\u0022\u0022,\u0022AnchorStyle\u0022:15}}],\u0022Count\u0022:0,\u0022Left\u0022:0,\u0022Top\u0022:0,\u0022Width\u0022:484,\u0022Height\u0022:476,\u0022Name\u0022:\u0022tab1\u0022,\u0022Text\u0022:\u0022\u0022,\u0022AnchorStyle\u0022:15}}],\u0022MemberCode\u0022:\u0022Controls.CreateHorizSplit(m_MsgPanel\u005Cu002c m_MsgEditor\u005Cu002c false);\u005Cu000d\u005Cu000a\u005Cu000d\u005Cu000avar m_From = new Date(0);\u005Cu000d\u005Cu000avar m_ErrorCount = 0;\u005Cu000d\u005Cu000a\u005Cu000d\u005Cu000afunction Receive()\u005Cu000d\u005Cu000a{\u005Cu000d\u005Cu000a    var data = {\u005Cu000d\u005Cu000a        Receiver: User\u005Cu002c\u005Cu000d\u005Cu000a        Sender: Peer\u005Cu002c\u005Cu000d\u005Cu000a        From: m_From\u005Cu000d\u005Cu000a    };\u005Cu000d\u005Cu000a\u005Cu000d\u005Cu000a    function Receive_Error(ex)\u005Cu000d\u005Cu000a    {\u005Cu000d\u005Cu000a        alert(ex);\u005Cu000d\u005Cu000a        m_ErrorCount++;\u005Cu000d\u005Cu000a        if (m_ErrorCount \u005Cu003c 5)\u005Cu000d\u005Cu000a        {\u005Cu000d\u005Cu000a            setTimeout(Receive\u005Cu002c 1000);\u005Cu000d\u005Cu000a        }\u005Cu000d\u005Cu000a    }\u005Cu000d\u005Cu000a\u005Cu000d\u005Cu000a    function Receive_Callback(xml\u005Cu002c text)\u005Cu000d\u005Cu000a    {\u005Cu000d\u005Cu000a        m_ErrorCount = 0;\u005Cu000d\u005Cu000a        var ret = System.ParseJson(text);\u005Cu000d\u005Cu000a        for (var i in ret.Messages)\u005Cu000d\u005Cu000a        {\u005Cu000d\u005Cu000a            m_MsgPanel.AddMessage(ret.Messages[i]);\u005Cu000d\u005Cu000a        }\u005Cu000d\u005Cu000a        if (ret.Messages.length \u005Cu003e 0)\u005Cu000d\u005Cu000a        {\u005Cu000d\u005Cu000a            m_From = ret.Messages[ret.Messages.length - 1].CreatedTime;\u005Cu000d\u005Cu000a        }\u005Cu000d\u005Cu000a        setTimeout(Receive\u005Cu002c 50);\u005Cu000d\u005Cu000a    }\u005Cu000d\u005Cu000a\u005Cu000d\u005Cu000a    System.Post(Receive_Callback\u005Cu002c Receive_Error\u005Cu002c \u005Cu0022recevie.aspx\u005Cu0022\u005Cu002c System.RenderJson(data));\u005Cu000d\u005Cu000a}\u005Cu000d\u005Cu000a\u005Cu000d\u005Cu000aReceive();\u0022,\u0022CustomConfig\u0022:\u0022config.Css = \u005Cu0022MainWnd\u005Cu0022;\u0022,\u0022BaseName\u0022:\u0022Control\u0022,\u0022GlobalCode\u0022:\u0022\u0022,\u0022Count\u0022:5,\u0022Left\u0022:11,\u0022Top\u0022:13,\u0022Width\u0022:484,\u0022Height\u0022:476,\u0022Name\u0022:\u0022MainWnd\u0022,\u0022Text\u0022:\u0022\u0022,\u0022AnchorStyle\u0022:0}},{\u0022Constructor\u0022:\u0022CustomControlDesignPH\u0022,\u0022Config\u0022:{\u0022Controls\u0022:[],\u0022MemberCode\u0022:\u0022This.AddMessage = function(msg)\u005Cu000d\u005Cu000a{\u005Cu000d\u005Cu000a    var msgDiv = This.GetDocument().createElement(\u005Cu0022DIV\u005Cu0022);\u005Cu000d\u005Cu000a    msgDiv.className = \u005Cu0022message\u005Cu0022;\u005Cu000d\u005Cu000a    msgDiv.innerHTML = String.format(MessageFormat\u005Cu002c msg.Sender\u005Cu002c DateToString(msg.CreatedTime == undefined ? new Date() : msg.CreatedTime)\u005Cu002c msg.Content);\u005Cu000d\u005Cu000a    This.GetDocument().body.appendChild(msgDiv);\u005Cu000d\u005Cu000a    msgDiv.scrollIntoView();\u005Cu000d\u005Cu000a    msgDiv = null;\u005Cu000d\u005Cu000a}\u005Cu000d\u005Cu000a\u005Cu000d\u005Cu000aThis.Link(\u005Cu0022StyleSheet\u005Cu0022\u005Cu002c \u005Cu0022Lesktop/Themes/Default/EditorCss.css\u005Cu0022\u005Cu002c \u005Cu0022text/css\u005Cu0022);\u0022,\u0022CustomConfig\u0022:\u0022config.BorderWidth = 1;\u005Cu000d\u005Cu000aconfig.Css = \u005Cu0022MsgPanel\u005Cu0022;\u0022,\u0022BaseName\u0022:\u0022Controls.Frame\u0022,\u0022GlobalCode\u0022:\u0022\u0022,\u0022Count\u0022:0,\u0022Left\u0022:108,\u0022Top\u0022:51,\u0022Width\u0022:200,\u0022Height\u0022:200,\u0022Name\u0022:\u0022MsgPanel\u0022,\u0022Text\u0022:\u0022CustomControl1\u0022,\u0022AnchorStyle\u0022:3}},{\u0022Constructor\u0022:\u0022FormPH\u0022,\u0022Config\u0022:{\u0022_Css\u0022:\u0022window\u0022,\u0022HasMinButton\u0022:false,\u0022HasMaxButton\u0022:false,\u0022Resizable\u0022:false,\u0022MemberCode\u0022:\u0022var m_Result = false;\u005Cu000d\u005Cu000a\u005Cu000d\u005Cu000aThis.GetResult = function()\u005Cu000d\u005Cu000a{\u005Cu000d\u005Cu000a    return m_Result;\u005Cu000d\u005Cu000a}\u005Cu000d\u005Cu000a\u005Cu000d\u005Cu000aThis.GetUser = function()\u005Cu000d\u005Cu000a{\u005Cu000d\u005Cu000a    return m_User.GetText();\u005Cu000d\u005Cu000a}\u005Cu000d\u005Cu000a\u005Cu000d\u005Cu000aThis.GetPeer = function()\u005Cu000d\u005Cu000a{\u005Cu000d\u005Cu000a    return m_Peer.GetText();\u005Cu000d\u005Cu000a}\u0022,\u0022CustomConfigCode\u0022:\u0022\u0022,\u0022Controls\u0022:[{\u0022Constructor\u0022:\u0022LabelPH\u0022,\u0022Config\u0022:{\u0022_Css\u0022:\u0022label\u0022,\u0022InitCode\u0022:\u0022\u0022,\u0022Count\u0022:0,\u0022Left\u0022:9,\u0022Top\u0022:19,\u0022Width\u0022:78,\u0022Height\u0022:14,\u0022Name\u0022:\u0022label1\u0022,\u0022Text\u0022:\u0022你的用户名：\u0022,\u0022AnchorStyle\u0022:3}},{\u0022Constructor\u0022:\u0022TextBoxPH\u0022,\u0022Config\u0022:{\u0022_Css\u0022:\u0022textbox\u0022,\u0022InitCode\u0022:\u0022\u0022,\u0022BorderWidth\u0022:1,\u0022Count\u0022:0,\u0022Left\u0022:96,\u0022Top\u0022:14,\u0022Width\u0022:216,\u0022Height\u0022:22,\u0022Name\u0022:\u0022m_User\u0022,\u0022Text\u0022:\u0022\u0022,\u0022AnchorStyle\u0022:3}},{\u0022Constructor\u0022:\u0022LabelPH\u0022,\u0022Config\u0022:{\u0022_Css\u0022:\u0022label\u0022,\u0022InitCode\u0022:\u0022\u0022,\u0022Count\u0022:0,\u0022Left\u0022:10,\u0022Top\u0022:52,\u0022Width\u0022:82,\u0022Height\u0022:14,\u0022Name\u0022:\u0022label3\u0022,\u0022Text\u0022:\u0022对方用户名：\u0022,\u0022AnchorStyle\u0022:3}},{\u0022Constructor\u0022:\u0022TextBoxPH\u0022,\u0022Config\u0022:{\u0022_Css\u0022:\u0022textbox\u0022,\u0022InitCode\u0022:\u0022\u0022,\u0022BorderWidth\u0022:1,\u0022Count\u0022:0,\u0022Left\u0022:96,\u0022Top\u0022:47,\u0022Width\u0022:215,\u0022Height\u0022:22,\u0022Name\u0022:\u0022m_Peer\u0022,\u0022Text\u0022:\u0022\u0022,\u0022AnchorStyle\u0022:3}},{\u0022Constructor\u0022:\u0022ButtonPH\u0022,\u0022Config\u0022:{\u0022_Css\u0022:\u0022button_default\u0022,\u0022OnClickCode\u0022:\u0022if (m_User.GetText() == \u005Cu0022\u005Cu0022)\u005Cu000d\u005Cu000a{\u005Cu000d\u005Cu000a    alert(\u005Cu0022请输入您的用户名！\u005Cu0022);\u005Cu000d\u005Cu000a    return;\u005Cu000d\u005Cu000a}\u005Cu000d\u005Cu000aif (m_Peer.GetText() == \u005Cu0022\u005Cu0022)\u005Cu000d\u005Cu000a{\u005Cu000d\u005Cu000a    alert(\u005Cu0022请输入对方用户名！\u005Cu0022);\u005Cu000d\u005Cu000a    return;\u005Cu000d\u005Cu000a}\u005Cu000d\u005Cu000am_Result = true;\u005Cu000d\u005Cu000aThis.Close();\u0022,\u0022InitCode\u0022:\u0022\u0022,\u0022Count\u0022:0,\u0022Left\u0022:214,\u0022Top\u0022:79,\u0022Width\u0022:96,\u0022Height\u0022:26,\u0022Name\u0022:\u0022button5\u0022,\u0022Text\u0022:\u0022开始会话\u0022,\u0022AnchorStyle\u0022:3}}],\u0022Count\u0022:5,\u0022Left\u0022:17,\u0022Top\u0022:34,\u0022Width\u0022:332,\u0022Height\u0022:144,\u0022Name\u0022:\u0022GetUserForm\u0022,\u0022Text\u0022:\u0022用户名\u0022,\u0022AnchorStyle\u0022:3}},{\u0022Constructor\u0022:\u0022CustomControlDesignPH\u0022,\u0022Config\u0022:{\u0022Controls\u0022:[],\u0022MemberCode\u0022:\u0022\u0022,\u0022CustomConfig\u0022:\u0022\u0022,\u0022BaseName\u0022:\u0022RichEditor\u0022,\u0022GlobalCode\u0022:\u0022\u0022,\u0022Count\u0022:0,\u0022Left\u0022:0,\u0022Top\u0022:0,\u0022Width\u0022:200,\u0022Height\u0022:200,\u0022Name\u0022:\u0022MsgEditor\u0022,\u0022Text\u0022:\u0022CustomControl1\u0022,\u0022AnchorStyle\u0022:3}}],\u0022InitCode\u0022:\u0022completeCallback();\u0022,\u0022DisposeCode\u0022:\u0022completeCallback();\u0022,\u0022ModuleGlobalCode\u0022:\u0022var User\u005Cu002c Peer;\u005Cu000d\u005Cu000a\u005Cu000d\u005Cu000avar MessageFormat=\u005Cu000d\u005Cu000a\u005Cu0022\u005Cu003cdiv class=\u005Cu0027message\u005Cu0027\u005Cu003e\u005Cu0022 + \u005Cu000d\u005Cu000a    \u005Cu0022\u005Cu003cdiv class=\u005Cu0027messageTitle\u005Cu0027\u005Cu003e\u005Cu0022 + \u005Cu000d\u005Cu000a        \u005Cu0022\u005Cu003cspan class=\u005Cu0027sender\u005Cu0027\u005Cu003e{0}\u005Cu003c/span\u005Cu003e\u005Cu0022 + \u005Cu000d\u005Cu000a        \u005Cu0022\u005Cu003cspan class=\u005Cu0027time\u005Cu0027\u005Cu003e{1}\u005Cu003c/span\u005Cu003e\u005Cu0022 + \u005Cu000d\u005Cu000a    \u005Cu0022\u005Cu003c/div\u005Cu003e\u005Cu0022 + \u005Cu000d\u005Cu000a    \u005Cu0022\u005Cu003cdiv class=\u005Cu0027messageContent\u005Cu0027\u005Cu003e{2}\u005Cu003c/div\u005Cu003e\u005Cu0022 + \u005Cu000d\u005Cu000a\u005Cu0022\u005Cu003c/div\u005Cu003e\u005Cu003cbr/\u005Cu003e\u005Cu0022;\u005Cu000d\u005Cu000a\u005Cu000d\u005Cu000a//格式化数字\u005Cu000d\u005Cu000afunction FormatNumber(num\u005Cu002c length)\u005Cu000d\u005Cu000a{\u005Cu000d\u005Cu000a    var s = num.toString();\u005Cu000d\u005Cu000a    var zero = \u005Cu0022\u005Cu0022;\u005Cu000d\u005Cu000a    for (var i = 0; i \u005Cu003c length - s.length; i++) zero += \u005Cu00220\u005Cu0022;\u005Cu000d\u005Cu000a    return zero + s;\u005Cu000d\u005Cu000a}\u005Cu000d\u005Cu000a\u005Cu000d\u005Cu000a//时间转字符串\u005Cu000d\u005Cu000afunction DateToString(date)\u005Cu000d\u005Cu000a{\u005Cu000d\u005Cu000a    return String.format(\u005Cu0022{0}-{1}-{2} {3}:{4}:{5}\u005Cu0022\u005Cu002c FormatNumber(date.getFullYear()\u005Cu002c 4)\u005Cu002c FormatNumber(date.getMonth() + 1\u005Cu002c 2)\u005Cu002c FormatNumber(date.getDate()\u005Cu002c 2)\u005Cu002c FormatNumber(date.getHours()\u005Cu002c 2)\u005Cu002c FormatNumber(date.getMinutes()\u005Cu002c 2)\u005Cu002c FormatNumber(date.getSeconds()\u005Cu002c 2));\u005Cu000d\u005Cu000a}\u0022,\u0022AppStartCode\u0022:\u0022var guform = new GetUserForm();\u005Cu000d\u005Cu000a\u005Cu000d\u005Cu000afunction GetUser_OnClose()\u005Cu000d\u005Cu000a{\u005Cu000d\u005Cu000a    if (guform.GetResult() == false) return;\u005Cu000d\u005Cu000a\u005Cu000d\u005Cu000a    User = guform.GetUser();\u005Cu000d\u005Cu000a    Peer = guform.GetPeer();\u005Cu000d\u005Cu000a\u005Cu000d\u005Cu000a    var form = new Window({\u005Cu000d\u005Cu000a        Left: 0\u005Cu002c\u005Cu000d\u005Cu000a        Top: 0\u005Cu002c\u005Cu000d\u005Cu000a        Width: 800\u005Cu002c\u005Cu000d\u005Cu000a        Height: 600\u005Cu002c\u005Cu000d\u005Cu000a        Parent: null\u005Cu002c\u005Cu000d\u005Cu000a        Css: \u005Cu0022window\u005Cu0022\u005Cu002c\u005Cu000d\u005Cu000a        BorderWidth: 6\u005Cu002c\u005Cu000d\u005Cu000a        HasMinButton: true\u005Cu002c\u005Cu000d\u005Cu000a        HasMaxButton: true\u005Cu002c\u005Cu000d\u005Cu000a        Title: {\u005Cu000d\u005Cu000a            InnerHTML: \u005Cu0022调试\u005Cu0022\u005Cu000d\u005Cu000a        }\u005Cu000d\u005Cu000a    });\u005Cu000d\u005Cu000a\u005Cu000d\u005Cu000a    m_MainForm = new MainWnd({\u005Cu000d\u005Cu000a        Left: 0\u005Cu002c\u005Cu000d\u005Cu000a        Top: 0\u005Cu002c\u005Cu000d\u005Cu000a        Width: form.GetClientWidth()\u005Cu002c\u005Cu000d\u005Cu000a        Height: form.GetClientHeight()\u005Cu002c\u005Cu000d\u005Cu000a        Parent: form\u005Cu002c\u005Cu000d\u005Cu000a        AnchorStyle: Controls.AnchorStyle.All\u005Cu002c\u005Cu000d\u005Cu000a        Css: \u005Cu0022mainwnd\u005Cu0022\u005Cu000d\u005Cu000a    });\u005Cu000d\u005Cu000a\u005Cu000d\u005Cu000a    form.OnClosed.Attach(\u005Cu000d\u005Cu000a    function()\u005Cu000d\u005Cu000a    {\u005Cu000d\u005Cu000a        CurrentApplication.Dispose();\u005Cu000d\u005Cu000a    });\u005Cu000d\u005Cu000a\u005Cu000d\u005Cu000a    form.MoveEx(\u005Cu0022center\u005Cu0022\u005Cu002c 0\u005Cu002c 0);\u005Cu000d\u005Cu000a    form.Show();\u005Cu000d\u005Cu000a}\u005Cu000d\u005Cu000a\u005Cu000d\u005Cu000aguform.OnClosed.Attach(GetUser_OnClose);\u005Cu000d\u005Cu000aguform.MoveEx(\u005Cu0022center\u005Cu0022\u005Cu002c 0\u005Cu002c -100);\u005Cu000d\u005Cu000aguform.Show();\u0022,\u0022AppGlobal\u0022:\u0022\u0022,\u0022AppTerminateCode\u0022:\u0022completeCallback();\u0022},\u0022Css\u0022:{\u0022CssCode\u0022:\u0022.MsgPanel\u005Cu000d\u005Cu000a{\u005Cu000d\u005Cu000a    border: solid 1px #D0D0D0;\u005Cu000d\u005Cu000a}\u005Cu000d\u005Cu000a\u005Cu000d\u005Cu000a.MainWnd\u005Cu000d\u005Cu000a{\u005Cu000d\u005Cu000a    background-color:#EFF0F2;\u005Cu000d\u005Cu000a}\u0022},\u0022Version\u0022:\u00221.0\u0022}"},
{"CreatedTime":{"__DataType":"Date","__Value":1274925286562.5},"Solution":"{\u0022Data\u0022:{\u0022Forms\u0022:[{\u0022Constructor\u0022:\u0022CustomControlDesignPH\u0022,\u0022Config\u0022:{\u0022Controls\u0022:[{\u0022Constructor\u0022:\u0022SimpleTabControlPH\u0022,\u0022Config\u0022:{\u0022_Css\u0022:\u0022simple_tab\u0022,\u0022_BorderWidth\u0022:1,\u0022OnSelectedTabCode\u0022:\u0022\u0022,\u0022InitCode\u0022:\u0022\u0022,\u0022Tabs\u0022:[{\u0022Text\u0022:\u0022聊天\u0022,\u0022Width\u0022:80,\u0022ID\u0022:\u0022ID000020\u0022,\u0022IsSelected\u0022:true}],\u0022DesignPHBs\u0022:[{\u0022Constructor\u0022:\u0022SimplePlaceHolder\u0022,\u0022Config\u0022:{\u0022Controls\u0022:[{\u0022Constructor\u0022:\u0022CustomControlObjectPH\u0022,\u0022Config\u0022:{\u0022_Css\u0022:\u0022control\u0022,\u0022ConfigCode\u0022:\u0022\u0022,\u0022InitCode\u0022:\u0022\u0022,\u0022ClassName\u0022:\u0022MsgPanel\u0022,\u0022Count\u0022:0,\u0022Left\u0022:5,\u0022Top\u0022:5,\u0022Width\u0022:472,\u0022Height\u0022:231,\u0022Name\u0022:\u0022m_MsgPanel\u0022,\u0022Text\u0022:\u0022\u0022,\u0022AnchorStyle\u0022:15}},{\u0022Constructor\u0022:\u0022ButtonPH\u0022,\u0022Config\u0022:{\u0022_Css\u0022:\u0022button_default\u0022,\u0022OnClickCode\u0022:\u0022var data = {\u005Cu000d\u005Cu000a    Sender: User\u005Cu002c\u005Cu000d\u005Cu000a    Receiver: Peer\u005Cu002c\u005Cu000d\u005Cu000a    Content: m_MsgEditor.GetValue()\u005Cu000d\u005Cu000a};\u005Cu000d\u005Cu000a\u005Cu000d\u005Cu000am_MsgPanel.AddMessage(data);\u005Cu000d\u005Cu000am_MsgEditor.SetValue(\u005Cu0022\u005Cu0022);\u005Cu000d\u005Cu000a\u005Cu000d\u005Cu000afunction Send_Error(ex)\u005Cu000d\u005Cu000a{\u005Cu000d\u005Cu000a    alert(ex);\u005Cu000d\u005Cu000a}\u005Cu000d\u005Cu000a\u005Cu000d\u005Cu000afunction Send_Callback(xml\u005Cu002c text)\u005Cu000d\u005Cu000a{\u005Cu000d\u005Cu000a    var message = System.ParseJson(text);\u005Cu000d\u005Cu000a}\u005Cu000d\u005Cu000a\u005Cu000d\u005Cu000aSystem.Post(Send_Callback\u005Cu002c Send_Error\u005Cu002c \u005Cu0022send.aspx\u005Cu0022\u005Cu002c System.RenderJson(data));\u0022,\u0022InitCode\u0022:\u0022\u0022,\u0022Count\u0022:0,\u0022Left\u0022:410,\u0022Top\u0022:415,\u0022Width\u0022:67,\u0022Height\u0022:26,\u0022Name\u0022:\u0022m_BtnOK\u0022,\u0022Text\u0022:\u0022发送\u0022,\u0022AnchorStyle\u0022:12}},{\u0022Constructor\u0022:\u0022CustomControlObjectPH\u0022,\u0022Config\u0022:{\u0022_Css\u0022:\u0022control\u0022,\u0022ConfigCode\u0022:\u0022m_MsgEditor_Config.BorderWidth = 1;\u005Cu000d\u005Cu000am_MsgEditor_Config.Css = \u005Cu0022richEditor\u005Cu0022;\u0022,\u0022InitCode\u0022:\u0022\u0022,\u0022ClassName\u0022:\u0022MsgEditor\u0022,\u0022Count\u0022:0,\u0022Left\u0022:5,\u0022Top\u0022:243,\u0022Width\u0022:472,\u0022Height\u0022:166,\u0022Name\u0022:\u0022m_MsgEditor\u0022,\u0022Text\u0022:\u0022\u0022,\u0022AnchorStyle\u0022:13}}],\u0022Count\u0022:0,\u0022Left\u0022:0,\u0022Top\u0022:0,\u0022Width\u0022:482,\u0022Height\u0022:449,\u0022Name\u0022:\u0022tab1.GetPanel(0)\u0022,\u0022Text\u0022:\u0022\u0022,\u0022AnchorStyle\u0022:15}}],\u0022Count\u0022:0,\u0022Left\u0022:0,\u0022Top\u0022:0,\u0022Width\u0022:484,\u0022Height\u0022:476,\u0022Name\u0022:\u0022tab1\u0022,\u0022Text\u0022:\u0022\u0022,\u0022AnchorStyle\u0022:15}}],\u0022MemberCode\u0022:\u0022Controls.CreateHorizSplit(m_MsgPanel\u005Cu002c m_MsgEditor\u005Cu002c false);\u005Cu000d\u005Cu000a\u005Cu000d\u005Cu000avar m_From = new Date(0);\u005Cu000d\u005Cu000avar m_ErrorCount = 0;\u005Cu000d\u005Cu000a\u005Cu000d\u005Cu000afunction Receive()\u005Cu000d\u005Cu000a{\u005Cu000d\u005Cu000a    var data = {\u005Cu000d\u005Cu000a        Receiver: User\u005Cu002c\u005Cu000d\u005Cu000a        Sender: Peer\u005Cu002c\u005Cu000d\u005Cu000a        From: m_From\u005Cu000d\u005Cu000a    };\u005Cu000d\u005Cu000a\u005Cu000d\u005Cu000a    function Receive_Error(ex)\u005Cu000d\u005Cu000a    {\u005Cu000d\u005Cu000a        alert(ex);\u005Cu000d\u005Cu000a        m_ErrorCount++;\u005Cu000d\u005Cu000a        if (m_ErrorCount \u005Cu003c 5)\u005Cu000d\u005Cu000a        {\u005Cu000d\u005Cu000a            setTimeout(Receive\u005Cu002c 1000);\u005Cu000d\u005Cu000a        }\u005Cu000d\u005Cu000a    }\u005Cu000d\u005Cu000a\u005Cu000d\u005Cu000a    function Receive_Callback(xml\u005Cu002c text)\u005Cu000d\u005Cu000a    {\u005Cu000d\u005Cu000a        m_ErrorCount = 0;\u005Cu000d\u005Cu000a        var ret = System.ParseJson(text);\u005Cu000d\u005Cu000a        for (var i in ret.Messages)\u005Cu000d\u005Cu000a        {\u005Cu000d\u005Cu000a            m_MsgPanel.AddMessage(ret.Messages[i]);\u005Cu000d\u005Cu000a        }\u005Cu000d\u005Cu000a        if (ret.Messages.length \u005Cu003e 0)\u005Cu000d\u005Cu000a        {\u005Cu000d\u005Cu000a            m_From = ret.Messages[ret.Messages.length - 1].CreatedTime;\u005Cu000d\u005Cu000a        }\u005Cu000d\u005Cu000a        setTimeout(Receive\u005Cu002c 50);\u005Cu000d\u005Cu000a    }\u005Cu000d\u005Cu000a\u005Cu000d\u005Cu000a    System.Post(Receive_Callback\u005Cu002c Receive_Error\u005Cu002c \u005Cu0022recevie.aspx\u005Cu0022\u005Cu002c System.RenderJson(data));\u005Cu000d\u005Cu000a}\u005Cu000d\u005Cu000a\u005Cu000d\u005Cu000aReceive();\u0022,\u0022CustomConfig\u0022:\u0022config.Css = \u005Cu0022MainWnd\u005Cu0022;\u0022,\u0022BaseName\u0022:\u0022Control\u0022,\u0022GlobalCode\u0022:\u0022\u0022,\u0022Count\u0022:5,\u0022Left\u0022:11,\u0022Top\u0022:13,\u0022Width\u0022:484,\u0022Height\u0022:476,\u0022Name\u0022:\u0022MainWnd\u0022,\u0022Text\u0022:\u0022\u0022,\u0022AnchorStyle\u0022:0}},{\u0022Constructor\u0022:\u0022CustomControlDesignPH\u0022,\u0022Config\u0022:{\u0022Controls\u0022:[],\u0022MemberCode\u0022:\u0022This.AddMessage = function(msg)\u005Cu000d\u005Cu000a{\u005Cu000d\u005Cu000a    var msgDiv = This.GetDocument().createElement(\u005Cu0022DIV\u005Cu0022);\u005Cu000d\u005Cu000a    msgDiv.className = \u005Cu0022message\u005Cu0022;\u005Cu000d\u005Cu000a    msgDiv.innerHTML = String.format(MessageFormat\u005Cu002c msg.Sender\u005Cu002c DateToString(msg.CreatedTime == undefined ? new Date() : msg.CreatedTime)\u005Cu002c msg.Content);\u005Cu000d\u005Cu000a    This.GetDocument().body.appendChild(msgDiv);\u005Cu000d\u005Cu000a    msgDiv.scrollIntoView();\u005Cu000d\u005Cu000a    msgDiv = null;\u005Cu000d\u005Cu000a}\u005Cu000d\u005Cu000a\u005Cu000d\u005Cu000aThis.Link(\u005Cu0022StyleSheet\u005Cu0022\u005Cu002c \u005Cu0022Lesktop/Themes/Default/EditorCss.css\u005Cu0022\u005Cu002c \u005Cu0022text/css\u005Cu0022);\u0022,\u0022CustomConfig\u0022:\u0022config.BorderWidth = 1;\u005Cu000d\u005Cu000aconfig.Css = \u005Cu0022MsgPanel\u005Cu0022;\u0022,\u0022BaseName\u0022:\u0022Controls.Frame\u0022,\u0022GlobalCode\u0022:\u0022\u0022,\u0022Count\u0022:0,\u0022Left\u0022:108,\u0022Top\u0022:51,\u0022Width\u0022:200,\u0022Height\u0022:200,\u0022Name\u0022:\u0022MsgPanel\u0022,\u0022Text\u0022:\u0022CustomControl1\u0022,\u0022AnchorStyle\u0022:3}},{\u0022Constructor\u0022:\u0022FormPH\u0022,\u0022Config\u0022:{\u0022_Css\u0022:\u0022window\u0022,\u0022HasMinButton\u0022:false,\u0022HasMaxButton\u0022:false,\u0022Resizable\u0022:false,\u0022MemberCode\u0022:\u0022var m_Result = false;\u005Cu000d\u005Cu000a\u005Cu000d\u005Cu000aThis.GetResult = function()\u005Cu000d\u005Cu000a{\u005Cu000d\u005Cu000a    return m_Result;\u005Cu000d\u005Cu000a}\u005Cu000d\u005Cu000a\u005Cu000d\u005Cu000aThis.GetUser = function()\u005Cu000d\u005Cu000a{\u005Cu000d\u005Cu000a    return m_User.GetText();\u005Cu000d\u005Cu000a}\u005Cu000d\u005Cu000a\u005Cu000d\u005Cu000aThis.GetPeer = function()\u005Cu000d\u005Cu000a{\u005Cu000d\u005Cu000a    return m_Peer.GetText();\u005Cu000d\u005Cu000a}\u0022,\u0022CustomConfigCode\u0022:\u0022\u0022,\u0022Controls\u0022:[{\u0022Constructor\u0022:\u0022LabelPH\u0022,\u0022Config\u0022:{\u0022_Css\u0022:\u0022label\u0022,\u0022InitCode\u0022:\u0022\u0022,\u0022Count\u0022:0,\u0022Left\u0022:9,\u0022Top\u0022:19,\u0022Width\u0022:78,\u0022Height\u0022:14,\u0022Name\u0022:\u0022label1\u0022,\u0022Text\u0022:\u0022你的用户名：\u0022,\u0022AnchorStyle\u0022:3}},{\u0022Constructor\u0022:\u0022TextBoxPH\u0022,\u0022Config\u0022:{\u0022_Css\u0022:\u0022textbox\u0022,\u0022InitCode\u0022:\u0022\u0022,\u0022BorderWidth\u0022:1,\u0022Count\u0022:0,\u0022Left\u0022:96,\u0022Top\u0022:14,\u0022Width\u0022:216,\u0022Height\u0022:22,\u0022Name\u0022:\u0022m_User\u0022,\u0022Text\u0022:\u0022\u0022,\u0022AnchorStyle\u0022:3}},{\u0022Constructor\u0022:\u0022LabelPH\u0022,\u0022Config\u0022:{\u0022_Css\u0022:\u0022label\u0022,\u0022InitCode\u0022:\u0022\u0022,\u0022Count\u0022:0,\u0022Left\u0022:10,\u0022Top\u0022:52,\u0022Width\u0022:82,\u0022Height\u0022:14,\u0022Name\u0022:\u0022label3\u0022,\u0022Text\u0022:\u0022对方用户名：\u0022,\u0022AnchorStyle\u0022:3}},{\u0022Constructor\u0022:\u0022TextBoxPH\u0022,\u0022Config\u0022:{\u0022_Css\u0022:\u0022textbox\u0022,\u0022InitCode\u0022:\u0022\u0022,\u0022BorderWidth\u0022:1,\u0022Count\u0022:0,\u0022Left\u0022:96,\u0022Top\u0022:47,\u0022Width\u0022:215,\u0022Height\u0022:22,\u0022Name\u0022:\u0022m_Peer\u0022,\u0022Text\u0022:\u0022\u0022,\u0022AnchorStyle\u0022:3}},{\u0022Constructor\u0022:\u0022ButtonPH\u0022,\u0022Config\u0022:{\u0022_Css\u0022:\u0022button_default\u0022,\u0022OnClickCode\u0022:\u0022if (m_User.GetText() == \u005Cu0022\u005Cu0022)\u005Cu000d\u005Cu000a{\u005Cu000d\u005Cu000a    alert(\u005Cu0022请输入您的用户名！\u005Cu0022);\u005Cu000d\u005Cu000a    return;\u005Cu000d\u005Cu000a}\u005Cu000d\u005Cu000aif (m_Peer.GetText() == \u005Cu0022\u005Cu0022)\u005Cu000d\u005Cu000a{\u005Cu000d\u005Cu000a    alert(\u005Cu0022请输入对方用户名！\u005Cu0022);\u005Cu000d\u005Cu000a    return;\u005Cu000d\u005Cu000a}\u005Cu000d\u005Cu000am_Result = true;\u005Cu000d\u005Cu000aThis.Close();\u0022,\u0022InitCode\u0022:\u0022\u0022,\u0022Count\u0022:0,\u0022Left\u0022:214,\u0022Top\u0022:79,\u0022Width\u0022:96,\u0022Height\u0022:26,\u0022Name\u0022:\u0022button5\u0022,\u0022Text\u0022:\u0022开始会话\u0022,\u0022AnchorStyle\u0022:3}}],\u0022Count\u0022:5,\u0022Left\u0022:17,\u0022Top\u0022:34,\u0022Width\u0022:332,\u0022Height\u0022:144,\u0022Name\u0022:\u0022GetUserForm\u0022,\u0022Text\u0022:\u0022用户名\u0022,\u0022AnchorStyle\u0022:3}},{\u0022Constructor\u0022:\u0022CustomControlDesignPH\u0022,\u0022Config\u0022:{\u0022Controls\u0022:[],\u0022MemberCode\u0022:\u0022\u0022,\u0022CustomConfig\u0022:\u0022\u0022,\u0022BaseName\u0022:\u0022RichEditor\u0022,\u0022GlobalCode\u0022:\u0022\u0022,\u0022Count\u0022:0,\u0022Left\u0022:0,\u0022Top\u0022:0,\u0022Width\u0022:200,\u0022Height\u0022:200,\u0022Name\u0022:\u0022MsgEditor\u0022,\u0022Text\u0022:\u0022CustomControl1\u0022,\u0022AnchorStyle\u0022:3}}],\u0022InitCode\u0022:\u0022completeCallback();\u0022,\u0022DisposeCode\u0022:\u0022completeCallback();\u0022,\u0022ModuleGlobalCode\u0022:\u0022var User\u005Cu002c Peer;\u005Cu000d\u005Cu000a\u005Cu000d\u005Cu000avar MessageFormat=\u005Cu000d\u005Cu000a\u005Cu0022\u005Cu003cdiv class=\u005Cu0027message\u005Cu0027\u005Cu003e\u005Cu0022 + \u005Cu000d\u005Cu000a    \u005Cu0022\u005Cu003cdiv class=\u005Cu0027messageTitle\u005Cu0027\u005Cu003e\u005Cu0022 + \u005Cu000d\u005Cu000a        \u005Cu0022\u005Cu003cspan class=\u005Cu0027sender\u005Cu0027\u005Cu003e{0}\u005Cu003c/span\u005Cu003e\u005Cu0022 + \u005Cu000d\u005Cu000a        \u005Cu0022\u005Cu003cspan class=\u005Cu0027time\u005Cu0027\u005Cu003e{1}\u005Cu003c/span\u005Cu003e\u005Cu0022 + \u005Cu000d\u005Cu000a    \u005Cu0022\u005Cu003c/div\u005Cu003e\u005Cu0022 + \u005Cu000d\u005Cu000a    \u005Cu0022\u005Cu003cdiv class=\u005Cu0027messageContent\u005Cu0027\u005Cu003e{2}\u005Cu003c/div\u005Cu003e\u005Cu0022 + \u005Cu000d\u005Cu000a\u005Cu0022\u005Cu003c/div\u005Cu003e\u005Cu003cbr/\u005Cu003e\u005Cu0022;\u005Cu000d\u005Cu000a\u005Cu000d\u005Cu000a//格式化数字\u005Cu000d\u005Cu000afunction FormatNumber(num\u005Cu002c length)\u005Cu000d\u005Cu000a{\u005Cu000d\u005Cu000a    var s = num.toString();\u005Cu000d\u005Cu000a    var zero = \u005Cu0022\u005Cu0022;\u005Cu000d\u005Cu000a    for (var i = 0; i \u005Cu003c length - s.length; i++) zero += \u005Cu00220\u005Cu0022;\u005Cu000d\u005Cu000a    return zero + s;\u005Cu000d\u005Cu000a}\u005Cu000d\u005Cu000a\u005Cu000d\u005Cu000a//时间转字符串\u005Cu000d\u005Cu000afunction DateToString(date)\u005Cu000d\u005Cu000a{\u005Cu000d\u005Cu000a    return String.format(\u005Cu0022{0}-{1}-{2} {3}:{4}:{5}\u005Cu0022\u005Cu002c FormatNumber(date.getFullYear()\u005Cu002c 4)\u005Cu002c FormatNumber(date.getMonth() + 1\u005Cu002c 2)\u005Cu002c FormatNumber(date.getDate()\u005Cu002c 2)\u005Cu002c FormatNumber(date.getHours()\u005Cu002c 2)\u005Cu002c FormatNumber(date.getMinutes()\u005Cu002c 2)\u005Cu002c FormatNumber(date.getSeconds()\u005Cu002c 2));\u005Cu000d\u005Cu000a}\u0022,\u0022AppStartCode\u0022:\u0022var guform = new GetUserForm();\u005Cu000d\u005Cu000a\u005Cu000d\u005Cu000afunction GetUser_OnClose()\u005Cu000d\u005Cu000a{\u005Cu000d\u005Cu000a    if (guform.GetResult() == false) return;\u005Cu000d\u005Cu000a\u005Cu000d\u005Cu000a    User = guform.GetUser();\u005Cu000d\u005Cu000a    Peer = guform.GetPeer();\u005Cu000d\u005Cu000a\u005Cu000d\u005Cu000a    var form = new Window({\u005Cu000d\u005Cu000a        Left: 0\u005Cu002c\u005Cu000d\u005Cu000a        Top: 0\u005Cu002c\u005Cu000d\u005Cu000a        Width: 800\u005Cu002c\u005Cu000d\u005Cu000a        Height: 600\u005Cu002c\u005Cu000d\u005Cu000a        Parent: null\u005Cu002c\u005Cu000d\u005Cu000a        Css: \u005Cu0022window\u005Cu0022\u005Cu002c\u005Cu000d\u005Cu000a        BorderWidth: 6\u005Cu002c\u005Cu000d\u005Cu000a        HasMinButton: true\u005Cu002c\u005Cu000d\u005Cu000a        HasMaxButton: true\u005Cu002c\u005Cu000d\u005Cu000a        Title: {\u005Cu000d\u005Cu000a            InnerHTML: \u005Cu0022调试\u005Cu0022\u005Cu000d\u005Cu000a        }\u005Cu000d\u005Cu000a    });\u005Cu000d\u005Cu000a\u005Cu000d\u005Cu000a    m_MainForm = new MainWnd({\u005Cu000d\u005Cu000a        Left: 0\u005Cu002c\u005Cu000d\u005Cu000a        Top: 0\u005Cu002c\u005Cu000d\u005Cu000a        Width: form.GetClientWidth()\u005Cu002c\u005Cu000d\u005Cu000a        Height: form.GetClientHeight()\u005Cu002c\u005Cu000d\u005Cu000a        Parent: form\u005Cu002c\u005Cu000d\u005Cu000a        AnchorStyle: Controls.AnchorStyle.All\u005Cu002c\u005Cu000d\u005Cu000a        Css: \u005Cu0022mainwnd\u005Cu0022\u005Cu000d\u005Cu000a    });\u005Cu000d\u005Cu000a\u005Cu000d\u005Cu000a    form.OnClosed.Attach(\u005Cu000d\u005Cu000a    function()\u005Cu000d\u005Cu000a    {\u005Cu000d\u005Cu000a        CurrentApplication.Dispose();\u005Cu000d\u005Cu000a    });\u005Cu000d\u005Cu000a\u005Cu000d\u005Cu000a    form.MoveEx(\u005Cu0022center\u005Cu0022\u005Cu002c 0\u005Cu002c 0);\u005Cu000d\u005Cu000a    form.Show();\u005Cu000d\u005Cu000a}\u005Cu000d\u005Cu000a\u005Cu000d\u005Cu000aguform.OnClosed.Attach(GetUser_OnClose);\u005Cu000d\u005Cu000aguform.MoveEx(\u005Cu0022center\u005Cu0022\u005Cu002c 0\u005Cu002c -100);\u005Cu000d\u005Cu000aguform.Show();\u0022,\u0022AppGlobal\u0022:\u0022\u0022,\u0022AppTerminateCode\u0022:\u0022completeCallback();\u0022},\u0022Css\u0022:{\u0022CssCode\u0022:\u0022.MsgPanel\u005Cu000d\u005Cu000a{\u005Cu000d\u005Cu000a    border: solid 1px #D0D0D0;\u005Cu000d\u005Cu000a}\u005Cu000d\u005Cu000a\u005Cu000d\u005Cu000a.MainWnd\u005Cu000d\u005Cu000a{\u005Cu000d\u005Cu000a    background-color:#EFF0F2;\u005Cu000d\u005Cu000a}\u0022},\u0022Version\u0022:\u00221.0\u0022}"},
{"CreatedTime":{"__DataType":"Date","__Value":1274925302375},"Solution":"{\u0022Data\u0022:{\u0022Forms\u0022:[{\u0022Constructor\u0022:\u0022CustomControlDesignPH\u0022,\u0022Config\u0022:{\u0022Controls\u0022:[{\u0022Constructor\u0022:\u0022SimpleTabControlPH\u0022,\u0022Config\u0022:{\u0022_Css\u0022:\u0022simple_tab\u0022,\u0022_BorderWidth\u0022:1,\u0022OnSelectedTabCode\u0022:\u0022\u0022,\u0022InitCode\u0022:\u0022\u0022,\u0022Tabs\u0022:[{\u0022Text\u0022:\u0022聊天\u0022,\u0022Width\u0022:80,\u0022ID\u0022:\u0022ID000020\u0022,\u0022IsSelected\u0022:true}],\u0022DesignPHBs\u0022:[{\u0022Constructor\u0022:\u0022SimplePlaceHolder\u0022,\u0022Config\u0022:{\u0022Controls\u0022:[{\u0022Constructor\u0022:\u0022CustomControlObjectPH\u0022,\u0022Config\u0022:{\u0022_Css\u0022:\u0022control\u0022,\u0022ConfigCode\u0022:\u0022\u0022,\u0022InitCode\u0022:\u0022\u0022,\u0022ClassName\u0022:\u0022MsgPanel\u0022,\u0022Count\u0022:0,\u0022Left\u0022:5,\u0022Top\u0022:5,\u0022Width\u0022:472,\u0022Height\u0022:231,\u0022Name\u0022:\u0022m_MsgPanel\u0022,\u0022Text\u0022:\u0022\u0022,\u0022AnchorStyle\u0022:15}},{\u0022Constructor\u0022:\u0022ButtonPH\u0022,\u0022Config\u0022:{\u0022_Css\u0022:\u0022button_default\u0022,\u0022OnClickCode\u0022:\u0022var data = {\u005Cu000d\u005Cu000a    Sender: User\u005Cu002c\u005Cu000d\u005Cu000a    Receiver: Peer\u005Cu002c\u005Cu000d\u005Cu000a    Content: m_MsgEditor.GetValue()\u005Cu000d\u005Cu000a};\u005Cu000d\u005Cu000a\u005Cu000d\u005Cu000am_MsgPanel.AddMessage(data);\u005Cu000d\u005Cu000am_MsgEditor.SetValue(\u005Cu0022\u005Cu0022);\u005Cu000d\u005Cu000a\u005Cu000d\u005Cu000afunction Send_Error(ex)\u005Cu000d\u005Cu000a{\u005Cu000d\u005Cu000a    alert(ex);\u005Cu000d\u005Cu000a}\u005Cu000d\u005Cu000a\u005Cu000d\u005Cu000afunction Send_Callback(xml\u005Cu002c text)\u005Cu000d\u005Cu000a{\u005Cu000d\u005Cu000a    var message = System.ParseJson(text);\u005Cu000d\u005Cu000a}\u005Cu000d\u005Cu000a\u005Cu000d\u005Cu000aSystem.Post(Send_Callback\u005Cu002c Send_Error\u005Cu002c \u005Cu0022send.aspx\u005Cu0022\u005Cu002c System.RenderJson(data));\u0022,\u0022InitCode\u0022:\u0022\u0022,\u0022Count\u0022:0,\u0022Left\u0022:410,\u0022Top\u0022:415,\u0022Width\u0022:67,\u0022Height\u0022:26,\u0022Name\u0022:\u0022m_BtnOK\u0022,\u0022Text\u0022:\u0022发送\u0022,\u0022AnchorStyle\u0022:12}},{\u0022Constructor\u0022:\u0022CustomControlObjectPH\u0022,\u0022Config\u0022:{\u0022_Css\u0022:\u0022control\u0022,\u0022ConfigCode\u0022:\u0022m_MsgEditor_Config.BorderWidth = 1;\u005Cu000d\u005Cu000am_MsgEditor_Config.Css = \u005Cu0022richEditor\u005Cu0022;\u0022,\u0022InitCode\u0022:\u0022\u0022,\u0022ClassName\u0022:\u0022MsgEditor\u0022,\u0022Count\u0022:0,\u0022Left\u0022:5,\u0022Top\u0022:243,\u0022Width\u0022:472,\u0022Height\u0022:166,\u0022Name\u0022:\u0022m_MsgEditor\u0022,\u0022Text\u0022:\u0022\u0022,\u0022AnchorStyle\u0022:13}}],\u0022Count\u0022:0,\u0022Left\u0022:0,\u0022Top\u0022:0,\u0022Width\u0022:482,\u0022Height\u0022:449,\u0022Name\u0022:\u0022tab1.GetPanel(0)\u0022,\u0022Text\u0022:\u0022\u0022,\u0022AnchorStyle\u0022:15}}],\u0022Count\u0022:0,\u0022Left\u0022:0,\u0022Top\u0022:0,\u0022Width\u0022:484,\u0022Height\u0022:476,\u0022Name\u0022:\u0022tab1\u0022,\u0022Text\u0022:\u0022\u0022,\u0022AnchorStyle\u0022:15}}],\u0022MemberCode\u0022:\u0022Controls.CreateHorizSplit(m_MsgPanel\u005Cu002c m_MsgEditor\u005Cu002c false);\u005Cu000d\u005Cu000a\u005Cu000d\u005Cu000avar m_From = new Date(0);\u005Cu000d\u005Cu000avar m_ErrorCount = 0;\u005Cu000d\u005Cu000a\u005Cu000d\u005Cu000afunction Receive()\u005Cu000d\u005Cu000a{\u005Cu000d\u005Cu000a    var data = {\u005Cu000d\u005Cu000a        Receiver: User\u005Cu002c\u005Cu000d\u005Cu000a        Sender: Peer\u005Cu002c\u005Cu000d\u005Cu000a        From: m_From\u005Cu000d\u005Cu000a    };\u005Cu000d\u005Cu000a\u005Cu000d\u005Cu000a    function Receive_Error(ex)\u005Cu000d\u005Cu000a    {\u005Cu000d\u005Cu000a        alert(ex);\u005Cu000d\u005Cu000a        m_ErrorCount++;\u005Cu000d\u005Cu000a        if (m_ErrorCount \u005Cu003c 5)\u005Cu000d\u005Cu000a        {\u005Cu000d\u005Cu000a            setTimeout(Receive\u005Cu002c 1000);\u005Cu000d\u005Cu000a        }\u005Cu000d\u005Cu000a    }\u005Cu000d\u005Cu000a\u005Cu000d\u005Cu000a    function Receive_Callback(xml\u005Cu002c text)\u005Cu000d\u005Cu000a    {\u005Cu000d\u005Cu000a        m_ErrorCount = 0;\u005Cu000d\u005Cu000a        var ret = System.ParseJson(text);\u005Cu000d\u005Cu000a        for (var i in ret.Messages)\u005Cu000d\u005Cu000a        {\u005Cu000d\u005Cu000a            m_MsgPanel.AddMessage(ret.Messages[i]);\u005Cu000d\u005Cu000a        }\u005Cu000d\u005Cu000a        if (ret.Messages.length \u005Cu003e 0)\u005Cu000d\u005Cu000a        {\u005Cu000d\u005Cu000a            m_From = ret.Messages[ret.Messages.length - 1].CreatedTime;\u005Cu000d\u005Cu000a        }\u005Cu000d\u005Cu000a        setTimeout(Receive\u005Cu002c 50);\u005Cu000d\u005Cu000a    }\u005Cu000d\u005Cu000a\u005Cu000d\u005Cu000a    System.Post(Receive_Callback\u005Cu002c Receive_Error\u005Cu002c \u005Cu0022recevie.aspx\u005Cu0022\u005Cu002c System.RenderJson(data));\u005Cu000d\u005Cu000a}\u005Cu000d\u005Cu000a\u005Cu000d\u005Cu000aReceive();\u0022,\u0022CustomConfig\u0022:\u0022config.Css = \u005Cu0022MainWnd\u005Cu0022;\u0022,\u0022BaseName\u0022:\u0022Control\u0022,\u0022GlobalCode\u0022:\u0022\u0022,\u0022Count\u0022:5,\u0022Left\u0022:11,\u0022Top\u0022:13,\u0022Width\u0022:484,\u0022Height\u0022:476,\u0022Name\u0022:\u0022MainWnd\u0022,\u0022Text\u0022:\u0022\u0022,\u0022AnchorStyle\u0022:0}},{\u0022Constructor\u0022:\u0022CustomControlDesignPH\u0022,\u0022Config\u0022:{\u0022Controls\u0022:[],\u0022MemberCode\u0022:\u0022This.AddMessage = function(msg)\u005Cu000d\u005Cu000a{\u005Cu000d\u005Cu000a    var msgDiv = This.GetDocument().createElement(\u005Cu0022DIV\u005Cu0022);\u005Cu000d\u005Cu000a    msgDiv.className = \u005Cu0022message\u005Cu0022;\u005Cu000d\u005Cu000a    msgDiv.innerHTML = String.format(MessageFormat\u005Cu002c msg.Sender\u005Cu002c DateToString(msg.CreatedTime == undefined ? new Date() : msg.CreatedTime)\u005Cu002c msg.Content);\u005Cu000d\u005Cu000a    This.GetDocument().body.appendChild(msgDiv);\u005Cu000d\u005Cu000a    msgDiv.scrollIntoView();\u005Cu000d\u005Cu000a    msgDiv = null;\u005Cu000d\u005Cu000a}\u005Cu000d\u005Cu000a\u005Cu000d\u005Cu000aThis.Link(\u005Cu0022StyleSheet\u005Cu0022\u005Cu002c \u005Cu0022Themes/Default/EditorCss.css\u005Cu0022\u005Cu002c \u005Cu0022text/css\u005Cu0022);\u0022,\u0022CustomConfig\u0022:\u0022config.BorderWidth = 1;\u005Cu000d\u005Cu000aconfig.Css = \u005Cu0022MsgPanel\u005Cu0022;\u0022,\u0022BaseName\u0022:\u0022Controls.Frame\u0022,\u0022GlobalCode\u0022:\u0022\u0022,\u0022Count\u0022:0,\u0022Left\u0022:108,\u0022Top\u0022:51,\u0022Width\u0022:200,\u0022Height\u0022:200,\u0022Name\u0022:\u0022MsgPanel\u0022,\u0022Text\u0022:\u0022CustomControl1\u0022,\u0022AnchorStyle\u0022:3}},{\u0022Constructor\u0022:\u0022FormPH\u0022,\u0022Config\u0022:{\u0022_Css\u0022:\u0022window\u0022,\u0022HasMinButton\u0022:false,\u0022HasMaxButton\u0022:false,\u0022Resizable\u0022:false,\u0022MemberCode\u0022:\u0022var m_Result = false;\u005Cu000d\u005Cu000a\u005Cu000d\u005Cu000aThis.GetResult = function()\u005Cu000d\u005Cu000a{\u005Cu000d\u005Cu000a    return m_Result;\u005Cu000d\u005Cu000a}\u005Cu000d\u005Cu000a\u005Cu000d\u005Cu000aThis.GetUser = function()\u005Cu000d\u005Cu000a{\u005Cu000d\u005Cu000a    return m_User.GetText();\u005Cu000d\u005Cu000a}\u005Cu000d\u005Cu000a\u005Cu000d\u005Cu000aThis.GetPeer = function()\u005Cu000d\u005Cu000a{\u005Cu000d\u005Cu000a    return m_Peer.GetText();\u005Cu000d\u005Cu000a}\u0022,\u0022CustomConfigCode\u0022:\u0022\u0022,\u0022Controls\u0022:[{\u0022Constructor\u0022:\u0022LabelPH\u0022,\u0022Config\u0022:{\u0022_Css\u0022:\u0022label\u0022,\u0022InitCode\u0022:\u0022\u0022,\u0022Count\u0022:0,\u0022Left\u0022:9,\u0022Top\u0022:19,\u0022Width\u0022:78,\u0022Height\u0022:14,\u0022Name\u0022:\u0022label1\u0022,\u0022Text\u0022:\u0022你的用户名：\u0022,\u0022AnchorStyle\u0022:3}},{\u0022Constructor\u0022:\u0022TextBoxPH\u0022,\u0022Config\u0022:{\u0022_Css\u0022:\u0022textbox\u0022,\u0022InitCode\u0022:\u0022\u0022,\u0022BorderWidth\u0022:1,\u0022Count\u0022:0,\u0022Left\u0022:96,\u0022Top\u0022:14,\u0022Width\u0022:216,\u0022Height\u0022:22,\u0022Name\u0022:\u0022m_User\u0022,\u0022Text\u0022:\u0022\u0022,\u0022AnchorStyle\u0022:3}},{\u0022Constructor\u0022:\u0022LabelPH\u0022,\u0022Config\u0022:{\u0022_Css\u0022:\u0022label\u0022,\u0022InitCode\u0022:\u0022\u0022,\u0022Count\u0022:0,\u0022Left\u0022:10,\u0022Top\u0022:52,\u0022Width\u0022:82,\u0022Height\u0022:14,\u0022Name\u0022:\u0022label3\u0022,\u0022Text\u0022:\u0022对方用户名：\u0022,\u0022AnchorStyle\u0022:3}},{\u0022Constructor\u0022:\u0022TextBoxPH\u0022,\u0022Config\u0022:{\u0022_Css\u0022:\u0022textbox\u0022,\u0022InitCode\u0022:\u0022\u0022,\u0022BorderWidth\u0022:1,\u0022Count\u0022:0,\u0022Left\u0022:96,\u0022Top\u0022:47,\u0022Width\u0022:215,\u0022Height\u0022:22,\u0022Name\u0022:\u0022m_Peer\u0022,\u0022Text\u0022:\u0022\u0022,\u0022AnchorStyle\u0022:3}},{\u0022Constructor\u0022:\u0022ButtonPH\u0022,\u0022Config\u0022:{\u0022_Css\u0022:\u0022button_default\u0022,\u0022OnClickCode\u0022:\u0022if (m_User.GetText() == \u005Cu0022\u005Cu0022)\u005Cu000d\u005Cu000a{\u005Cu000d\u005Cu000a    alert(\u005Cu0022请输入您的用户名！\u005Cu0022);\u005Cu000d\u005Cu000a    return;\u005Cu000d\u005Cu000a}\u005Cu000d\u005Cu000aif (m_Peer.GetText() == \u005Cu0022\u005Cu0022)\u005Cu000d\u005Cu000a{\u005Cu000d\u005Cu000a    alert(\u005Cu0022请输入对方用户名！\u005Cu0022);\u005Cu000d\u005Cu000a    return;\u005Cu000d\u005Cu000a}\u005Cu000d\u005Cu000am_Result = true;\u005Cu000d\u005Cu000aThis.Close();\u0022,\u0022InitCode\u0022:\u0022\u0022,\u0022Count\u0022:0,\u0022Left\u0022:214,\u0022Top\u0022:79,\u0022Width\u0022:96,\u0022Height\u0022:26,\u0022Name\u0022:\u0022button5\u0022,\u0022Text\u0022:\u0022开始会话\u0022,\u0022AnchorStyle\u0022:3}}],\u0022Count\u0022:5,\u0022Left\u0022:17,\u0022Top\u0022:34,\u0022Width\u0022:332,\u0022Height\u0022:144,\u0022Name\u0022:\u0022GetUserForm\u0022,\u0022Text\u0022:\u0022用户名\u0022,\u0022AnchorStyle\u0022:3}},{\u0022Constructor\u0022:\u0022CustomControlDesignPH\u0022,\u0022Config\u0022:{\u0022Controls\u0022:[],\u0022MemberCode\u0022:\u0022\u0022,\u0022CustomConfig\u0022:\u0022\u0022,\u0022BaseName\u0022:\u0022RichEditor\u0022,\u0022GlobalCode\u0022:\u0022\u0022,\u0022Count\u0022:0,\u0022Left\u0022:0,\u0022Top\u0022:0,\u0022Width\u0022:200,\u0022Height\u0022:200,\u0022Name\u0022:\u0022MsgEditor\u0022,\u0022Text\u0022:\u0022CustomControl1\u0022,\u0022AnchorStyle\u0022:3}}],\u0022InitCode\u0022:\u0022completeCallback();\u0022,\u0022DisposeCode\u0022:\u0022completeCallback();\u0022,\u0022ModuleGlobalCode\u0022:\u0022var User\u005Cu002c Peer;\u005Cu000d\u005Cu000a\u005Cu000d\u005Cu000avar MessageFormat=\u005Cu000d\u005Cu000a\u005Cu0022\u005Cu003cdiv class=\u005Cu0027message\u005Cu0027\u005Cu003e\u005Cu0022 + \u005Cu000d\u005Cu000a    \u005Cu0022\u005Cu003cdiv class=\u005Cu0027messageTitle\u005Cu0027\u005Cu003e\u005Cu0022 + \u005Cu000d\u005Cu000a        \u005Cu0022\u005Cu003cspan class=\u005Cu0027sender\u005Cu0027\u005Cu003e{0}\u005Cu003c/span\u005Cu003e\u005Cu0022 + \u005Cu000d\u005Cu000a        \u005Cu0022\u005Cu003cspan class=\u005Cu0027time\u005Cu0027\u005Cu003e{1}\u005Cu003c/span\u005Cu003e\u005Cu0022 + \u005Cu000d\u005Cu000a    \u005Cu0022\u005Cu003c/div\u005Cu003e\u005Cu0022 + \u005Cu000d\u005Cu000a    \u005Cu0022\u005Cu003cdiv class=\u005Cu0027messageContent\u005Cu0027\u005Cu003e{2}\u005Cu003c/div\u005Cu003e\u005Cu0022 + \u005Cu000d\u005Cu000a\u005Cu0022\u005Cu003c/div\u005Cu003e\u005Cu003cbr/\u005Cu003e\u005Cu0022;\u005Cu000d\u005Cu000a\u005Cu000d\u005Cu000a//格式化数字\u005Cu000d\u005Cu000afunction FormatNumber(num\u005Cu002c length)\u005Cu000d\u005Cu000a{\u005Cu000d\u005Cu000a    var s = num.toString();\u005Cu000d\u005Cu000a    var zero = \u005Cu0022\u005Cu0022;\u005Cu000d\u005Cu000a    for (var i = 0; i \u005Cu003c length - s.length; i++) zero += \u005Cu00220\u005Cu0022;\u005Cu000d\u005Cu000a    return zero + s;\u005Cu000d\u005Cu000a}\u005Cu000d\u005Cu000a\u005Cu000d\u005Cu000a//时间转字符串\u005Cu000d\u005Cu000afunction DateToString(date)\u005Cu000d\u005Cu000a{\u005Cu000d\u005Cu000a    return String.format(\u005Cu0022{0}-{1}-{2} {3}:{4}:{5}\u005Cu0022\u005Cu002c FormatNumber(date.getFullYear()\u005Cu002c 4)\u005Cu002c FormatNumber(date.getMonth() + 1\u005Cu002c 2)\u005Cu002c FormatNumber(date.getDate()\u005Cu002c 2)\u005Cu002c FormatNumber(date.getHours()\u005Cu002c 2)\u005Cu002c FormatNumber(date.getMinutes()\u005Cu002c 2)\u005Cu002c FormatNumber(date.getSeconds()\u005Cu002c 2));\u005Cu000d\u005Cu000a}\u0022,\u0022AppStartCode\u0022:\u0022var guform = new GetUserForm();\u005Cu000d\u005Cu000a\u005Cu000d\u005Cu000afunction GetUser_OnClose()\u005Cu000d\u005Cu000a{\u005Cu000d\u005Cu000a    if (guform.GetResult() == false) return;\u005Cu000d\u005Cu000a\u005Cu000d\u005Cu000a    User = guform.GetUser();\u005Cu000d\u005Cu000a    Peer = guform.GetPeer();\u005Cu000d\u005Cu000a\u005Cu000d\u005Cu000a    var form = new Window({\u005Cu000d\u005Cu000a        Left: 0\u005Cu002c\u005Cu000d\u005Cu000a        Top: 0\u005Cu002c\u005Cu000d\u005Cu000a        Width: 800\u005Cu002c\u005Cu000d\u005Cu000a        Height: 600\u005Cu002c\u005Cu000d\u005Cu000a        Parent: null\u005Cu002c\u005Cu000d\u005Cu000a        Css: \u005Cu0022window\u005Cu0022\u005Cu002c\u005Cu000d\u005Cu000a        BorderWidth: 6\u005Cu002c\u005Cu000d\u005Cu000a        HasMinButton: true\u005Cu002c\u005Cu000d\u005Cu000a        HasMaxButton: true\u005Cu002c\u005Cu000d\u005Cu000a        Title: {\u005Cu000d\u005Cu000a            InnerHTML: \u005Cu0022调试\u005Cu0022\u005Cu000d\u005Cu000a        }\u005Cu000d\u005Cu000a    });\u005Cu000d\u005Cu000a\u005Cu000d\u005Cu000a    m_MainForm = new MainWnd({\u005Cu000d\u005Cu000a        Left: 0\u005Cu002c\u005Cu000d\u005Cu000a        Top: 0\u005Cu002c\u005Cu000d\u005Cu000a        Width: form.GetClientWidth()\u005Cu002c\u005Cu000d\u005Cu000a        Height: form.GetClientHeight()\u005Cu002c\u005Cu000d\u005Cu000a        Parent: form\u005Cu002c\u005Cu000d\u005Cu000a        AnchorStyle: Controls.AnchorStyle.All\u005Cu002c\u005Cu000d\u005Cu000a        Css: \u005Cu0022mainwnd\u005Cu0022\u005Cu000d\u005Cu000a    });\u005Cu000d\u005Cu000a\u005Cu000d\u005Cu000a    form.OnClosed.Attach(\u005Cu000d\u005Cu000a    function()\u005Cu000d\u005Cu000a    {\u005Cu000d\u005Cu000a        CurrentApplication.Dispose();\u005Cu000d\u005Cu000a    });\u005Cu000d\u005Cu000a\u005Cu000d\u005Cu000a    form.MoveEx(\u005Cu0022center\u005Cu0022\u005Cu002c 0\u005Cu002c 0);\u005Cu000d\u005Cu000a    form.Show();\u005Cu000d\u005Cu000a}\u005Cu000d\u005Cu000a\u005Cu000d\u005Cu000aguform.OnClosed.Attach(GetUser_OnClose);\u005Cu000d\u005Cu000aguform.MoveEx(\u005Cu0022center\u005Cu0022\u005Cu002c 0\u005Cu002c -100);\u005Cu000d\u005Cu000aguform.Show();\u0022,\u0022AppGlobal\u0022:\u0022\u0022,\u0022AppTerminateCode\u0022:\u0022completeCallback();\u0022},\u0022Css\u0022:{\u0022CssCode\u0022:\u0022.MsgPanel\u005Cu000d\u005Cu000a{\u005Cu000d\u005Cu000a    border: solid 1px #D0D0D0;\u005Cu000d\u005Cu000a}\u005Cu000d\u005Cu000a\u005Cu000d\u005Cu000a.MainWnd\u005Cu000d\u005Cu000a{\u005Cu000d\u005Cu000a    background-color:#EFF0F2;\u005Cu000d\u005Cu000a}\u0022},\u0022Version\u0022:\u00221.0\u0022}"},
